{"name":"Lean.Compiler.IR.Borrow","instances":[{"typeNames":["Lean.IR.Borrow.OwnedSet.Key"],"name":"Lean.IR.Borrow.OwnedSet.instBEqKey","className":"BEq"},{"typeNames":["Lean.IR.Borrow.OwnedSet.Key"],"name":"Lean.IR.Borrow.OwnedSet.instHashableKey","className":"Hashable"},{"typeNames":["Lean.IR.Borrow.ParamMap.Key"],"name":"Lean.IR.Borrow.ParamMap.instBEqKey","className":"BEq"},{"typeNames":["Lean.IR.Borrow.ParamMap.Key"],"name":"Lean.IR.Borrow.ParamMap.instHashableKey","className":"Hashable"},{"typeNames":["Lean.IR.Borrow.ParamMap"],"name":"Lean.IR.Borrow.instToFormatParamMap","className":"Std.ToFormat"},{"typeNames":["Lean.IR.Borrow.ParamMap"],"name":"Lean.IR.Borrow.instToStringParamMap","className":"ToString"}],"imports":["Init","Lean.Compiler.ExportAttr","Lean.Compiler.IR.CompilerM","Lean.Compiler.IR.NormIds"],"declarations":[{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L310-L313","name":"Lean.IR.inferBorrow","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.inferBorrow","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L305-L306","name":"Lean.IR.Borrow.infer","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.infer","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L300-L303","name":"Lean.IR.Borrow.collectDecls","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.collectDecls","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L291-L298","name":"Lean.IR.Borrow.whileModifing","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.whileModifing","doc":"Keep executing `x` until it reaches a fixpoint "},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L283-L288","name":"Lean.IR.Borrow.collectDecl","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.collectDecl","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L268-L281","name":"Lean.IR.Borrow.collectFnBody","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.collectFnBody","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L265-L266","name":"Lean.IR.Borrow.updateParamSet","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.updateParamSet","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L256-L263","name":"Lean.IR.Borrow.preserveTailCall","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.preserveTailCall","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L242-L254","name":"Lean.IR.Borrow.collectExpr","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.collectExpr","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L235-L240","name":"Lean.IR.Borrow.ownArgsIfParam","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ownArgsIfParam","doc":"Mark `xs[i]` as owned if it is one of the parameters `ps`.\nWe use this action to mark function parameters that are being \"packed\" inside constructors.\nThis is a heuristic, and is not related with the effectiveness of the reset/reuse optimization.\nIt is useful for code such as\n```\ndef f (x y : obj) :=\nlet z := ctor_1 x y;\nret z\n```\n"},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L217-L223","name":"Lean.IR.Borrow.ownParamsUsingArgs","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ownParamsUsingArgs","doc":"For each xs[i], if xs[i] is owned, then mark ps[i] as owned.\nWe use this action to preserve tail calls. That is, if we have\na tail call `f xs`, if the i-th parameter is borrowed, but `xs[i]` is owned\nwe would have to insert a `dec xs[i]` after `f xs` and consequently\n\"break\" the tail call. "},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L206-L210","name":"Lean.IR.Borrow.ownArgsUsingParams","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ownArgsUsingParams","doc":"For each ps[i], if ps[i] is owned, then mark xs[i] as owned. "},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L192-L203","name":"Lean.IR.Borrow.getParamInfo","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.getParamInfo","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L178-L190","name":"Lean.IR.Borrow.updateParamMap","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.updateParamMap","doc":"Updates `map[k]` using the current set of `owned` variables. "},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L172-L175","name":"Lean.IR.Borrow.isOwned","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.isOwned","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L169-L170","name":"Lean.IR.Borrow.ownArgs","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ownArgs","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L164-L167","name":"Lean.IR.Borrow.ownArg","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ownArg","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L158-L162","name":"Lean.IR.Borrow.ownVar","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ownVar","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L155-L156","name":"Lean.IR.Borrow.markModified","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.markModified","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L151-L153","name":"Lean.IR.Borrow.getCurrFn","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.getCurrFn","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L149-L149","name":"Lean.IR.Borrow.M","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.M","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L143-L147","name":"Lean.IR.Borrow.BorrowInfState","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.BorrowInfState","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L137-L141","name":"Lean.IR.Borrow.BorrowInfCtx","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.BorrowInfCtx","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L134-L135","name":"Lean.IR.Borrow.applyParamMap","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.applyParamMap","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L123-L130","name":"Lean.IR.Borrow.ApplyParamMap.visitDecls","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ApplyParamMap.visitDecls","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L107-L121","name":"Lean.IR.Borrow.ApplyParamMap.visitFnBody","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ApplyParamMap.visitFnBody","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L100-L101","name":"Lean.IR.Borrow.mkInitParamMap","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.mkInitParamMap","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L91-L97","name":"Lean.IR.Borrow.InitParamMap.visitDecls","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.InitParamMap.visitDecls","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L80-L89","name":"Lean.IR.Borrow.InitParamMap.visitFnBody","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.InitParamMap.visitFnBody","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L77-L78","name":"Lean.IR.Borrow.InitParamMap.initBorrowIfNotExported","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.InitParamMap.initBorrowIfNotExported","doc":"We do perform borrow inference for constants marked as `export`.\nReason: we current write wrappers in C++ for using exported functions.\nThese wrappers use smart pointers such as `object_ref`.\nWhen writing a new wrapper we need to know whether an argument is a borrow\ninference or not.\nWe can revise this decision when we implement code for generating\nthe wrappers automatically. "},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L67-L68","name":"Lean.IR.Borrow.InitParamMap.initBorrow","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.InitParamMap.initBorrow","doc":"Mark parameters that take a reference as borrow "},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L63-L63","name":"Lean.IR.Borrow.instToStringParamMap","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.instToStringParamMap","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L62-L62","name":"Lean.IR.Borrow.instToFormatParamMap","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.instToFormatParamMap","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L53-L60","name":"Lean.IR.Borrow.ParamMap.fmt","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ParamMap.fmt","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L51-L51","name":"Lean.IR.Borrow.ParamMap","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ParamMap","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L47-L47","name":"Lean.IR.Borrow.ParamMap.instHashableKey","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ParamMap.instHashableKey","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L43-L45","name":"Lean.IR.Borrow.ParamMap.getHash","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ParamMap.getHash","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L41-L41","name":"Lean.IR.Borrow.ParamMap.instBEqKey","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ParamMap.instBEqKey","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L38-L41","name":"Lean.IR.Borrow.ParamMap.Key","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.ParamMap.Key","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L30-L30","name":"Lean.IR.Borrow.OwnedSet.contains","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.OwnedSet.contains","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L29-L29","name":"Lean.IR.Borrow.OwnedSet.insert","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.OwnedSet.insert","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L28-L28","name":"Lean.IR.Borrow.OwnedSet","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.OwnedSet","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L24-L24","name":"Lean.IR.Borrow.OwnedSet.instHashableKey","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.OwnedSet.instHashableKey","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L22-L23","name":"Lean.IR.Borrow.OwnedSet.getHash","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.OwnedSet.getHash","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L20-L20","name":"Lean.IR.Borrow.OwnedSet.instBEqKey","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.OwnedSet.instBEqKey","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L17-L18","name":"Lean.IR.Borrow.OwnedSet.beq","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.OwnedSet.beq","doc":""},{"sourceLink":"https://github.com/leanprover/lean4/blob/23ba495205f8133628d85dde572aad0c1089c094/src/Lean/Compiler/IR/Borrow.lean#L15-L15","name":"Lean.IR.Borrow.OwnedSet.Key","docLink":"./Lean/Compiler/IR/Borrow.html#Lean.IR.Borrow.OwnedSet.Key","doc":""}]}